---
layout: post
tags: [Git] # add tag
img: git_2.jpg
---

# Git 精简（七）- 对 Fork 的项目进行贡献

## 发送 Pull Request

由于我们并没有向其他人的项目 发送 push 请求的权限，可是当我们发现 forked 下来的代码存在问题，或者对项目有了自己的想法或贡献，可以发送 Pull Request

注意关注 `CONTRIBUTING.md` 文件，按照文件的要求填写贡献的信息

---

## 提交 issues

在对文件作出改变时，可以先发出一个 issue，然后等待维护者的回复，然后再进行项目的贡献

当你花费大量时间更改了很多的内容，可以提出一个 issue 避免其他的人也浪费这么多的时间，去改变相同的问题

---

## 做出改变的规范

当你进行贡献时，不应该在 master 分支进行改变，应该使用 `topic branch` 进行改变

> topic branch 表示对某一特定问题起名的分支

比如：

* login
* login-bug
* signup-bug
* login-from-bug

Before you start doing any work, make sure to look for the project's CONTRIBUTING.md file.

在你开始工作前，请确保查看了相应工程的 'CONTRIBUTING.md' 文件

Next, it's a good idea to look at the GitHub issues for the project

接下来，查看一下 issues 页

look at the existing issues to see if one is similar to the change you want to contribute

看看当前存在的问题中，是不是已经和你要提出的问题中存在一样的问题。

if necessary create a new issue
必要的话可以创建一个 issue

communicate the changes you'd like to make to the project maintainer in the issue

和工程的维护着交流你想做出改变的地方

When you start developing, commit all of your work on a topic branch:do not work on the master branch

在准备开发前，创建一个新的 topic branch 分支，而不是在主分支上

make sure to give the topic branch clear, descriptive name
As a general best practice for writing commits:

确保新创建的 topic branch 是干净的，请起一个合适的命令，举例如下：

make frequent, smaller commits
use clear and descriptive commit messages
update the README file, if necessary

---

## 关注某个仓库的最新动态

可以找到对应的 project 点击 star

当想要关注的某个 project 发生变化时，通知你可以点击 watch

---

## fork 后 工程保持更新的方法

To get commits from a source repository into your forked repository on GitHub you need to:

在 fork 某个工程后，想要保持该工程下一直是最新状态的方法

* get the cloneable URL of the source repository
* 复制原工程的 url （不是自己 fork 的url）


* create a new remote with the git remote add command
* 在自己的工程下创建一个远程仓库用刚才拷贝的 url


* use the shortname upstream to point to the source repository
* 起一个合适的名字代替指向仓库


* provide the URL of the source repository
* 提供原仓库的 url


* fetch the new upstream remote
* 使用 fetch 命令获取原仓库的改变到本地


* merge the upstream's branch into a local branch
* 合并 fetch 下来的仓库


* push the newly updated local branch to your origin repo
* push 合并后的改变到自己 fork 下的分支中

---

## 提交 pull request

If the project's maintainer is requesting changes to the pull request, then:

如果项目的维护者要求发生的改变通过 pull requset

* make any necessary commits on the same branch in your local repository that your pull request is based on
* 在你要发送 pull request 的本地分支上进行改变


* push the branch to the your fork of the source repository
* 将改变 push 到 fork 的工程上


* The commits will then show up on the pull request page.
* push 后的内容将会出现在 发送 pull request 的页面上

---

## 合并多个 commit

将多个提交的 commit 合并成一个 commit，并擦除旧的 commit

使用 rebase 命令之前，记得先**备份**一下，再进行 rebase 操作

<img src="{{site.baseurl}}/assets/img/15094336571861.jpg" alt="rebase" />

使用 rebase 命令之后, `git rebase -i HEAD~3`

<img src="{{site.baseurl}}/assets/img/15094337832207.jpg" alt="rebase-1"/>

---

**实践：**

假设我们已经提交了三个 commit，并且已经 push 到远程仓库，这时发现三个 commit 的内容修改的十分类似，想把三个 commit 融合成一个大的commit 这时就需要 rebase 命令

使用 `git rebase -i HEAD~3` 后会在编译器弹出相应的修改提示（按照时间顺序排序），问你怎样去融合 这多个 commit，按照步骤保存即可

这时再使用 `git log` 就会发现最近的三个 commit，已经融合成一个 commit，也可以使用 `git log --oneline --graph --decorate --all` 查看发生的改变信息

> 如果更改已经 push 到远程仓库的 commit，可能会出现如下的错误

```
To https://github.com/BAZINGAyi/my-travel-plans.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'https://github.com/BAZINGAyi/my-travel-plans.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Integrate the remote changes (e.g.
hint: 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
```

> 原因是合并后大的 commit，会删除之前的若干个小 commit，这时本来的 HEAD 的指向是小于远程仓库 HEAD 的指向的，所以需要我们使用强制 push 操作：
> git push -f origin master



